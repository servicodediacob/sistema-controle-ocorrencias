services:
  - type: web
    name: sistema-ocorrencias-api
    env: node
    region: oregon
    plan: free
    rootDir: api
    
    # --- CORREÇÃO APLICADA AQUI ---
    # A chave 'buildFilter' é o objeto pai, e 'paths' é uma de suas propriedades.
    # Eles não devem estar no mesmo nível.
    buildFilter:
      paths:
        - "api/**/*"
        - "render.yaml" # Adicionado: Também aciona um deploy se a própria configuração mudar.
      ignoredPaths:
        - "frontend/**/*" # Adicionado: Ignora explicitamente mudanças no frontend.

    buildCommand: "npm install && npm run build"
    startCommand: "npm run start"
    
    healthCheck:
      path: /api/health
