// api/src/tests/setup.ts
import { server } from '../server';
import db from '../db';
import { seedDatabase } from '../db/seed';

beforeAll(async () => {
  // Inicia o servidor (se ele nÃ£o estiver ouvindo, o supertest o farÃ¡)
  // Apenas garantimos que o banco estÃ¡ pronto.
  await seedDatabase(); // Semeia o banco uma vez no inÃ­cio
  console.log('ðŸš€ Banco de dados semeado para o inÃ­cio dos testes.');
});

afterAll(async () => {
  server.close(); // Fecha o servidor HTTP
  await db.pool.end(); // Fecha todas as conexÃµes com o banco
  console.log('ðŸ›‘ Servidor e pool do banco de dados fechados.');
});
